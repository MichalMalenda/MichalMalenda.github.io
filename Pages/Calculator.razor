@page "/calculator"
<title>Calculator</title>
<h1>Calculator</h1>
<div class="display">
    <div class="result">
        <p id="result">@result</p>
    </div>
    <div class="zero-row">
        <button @onclick="() => Mod()" id="r1-3">%</button>
        <button @onclick="() => Clear()" id="r1-1">CE</button>
        <button @onclick="() => Clear()" id="r1-1">C</button>
        <button @onclick="() => Back()" id="r1-4 "><span class="bi bi-backspace" aria-hidden="true"></span></button>
    </div>
    <div class="first-row">
        <button @onclick="() => Under()" id="r1-1">1/x</button>
        <button @onclick="() => Sup()" id="r1-3">x<sup>2</sup></button>
        <button @onclick="() => Root()" id="r1-4">√x</button>
        <button @onclick="() => Divide()" id="r1-4">/</button>
    </div>
    <div class="second-row">
        <button @onclick="() => Set(7)" id="r2-1">7</button>
        <button @onclick="() => Set(8)" id="r2-2">8</button>
        <button @onclick="() => Set(9)" id="r2-3">9</button>
        <button @onclick="() => Multiply()" id="r2-4">x</button>
    </div>
    <div class="third-row">
        <button @onclick="() => Set(4)" id="r3-1">4</button>
        <button @onclick="() => Set(5)" id="r3-2">5</button>
        <button @onclick="() => Set(6)" id="r3-3">6</button>
        <button @onclick="() => Subtract()" id="r3-4">-</button>
    </div>
    <div class="fourth-row">
        <button @onclick="() => Set(1)" id="r4-1">1</button>
        <button @onclick="() => Set(2)" id="r4-2">2</button>
        <button @onclick="() => Set(3)" id="r4-3">3</button>
        <button @onclick="() => Add()" id="r4-4">+</button>
    </div>
    <div class="fifth-row">
        <button @onclick="() => Swap()" id="r5-1">+/-</button>
        <button @onclick="() => Set(0)" id="r5-2">0</button>
        <button @onclick="() => Dot()" id="r5-3">.</button>
        <button @onclick="() => Equal()" id="r5-4">=</button>
    </div>
</div>

@code {
    private string result = "0";
    private string action;
    private double a, b = 0;
    private void Clear(){
        result = "0";
        a = 0;
        b = 0;
    }

    private void Set(double number){
        if (result == "0"){
            result = number.ToString();
        }else{
            result = result+number.ToString();
        }
    }

    private void Dot(){
        result = result + ".";
    }

    private void Add(){
        a = double.Parse(result);
        action = "add";
        result = "0";
    }
    private void Subtract(){
        a = double.Parse(result);
        action = "subtract";
        result = "0";
    }
    private void Multiply(){
        a = double.Parse(result);
        action = "multiply";
        result = "0";
    }
    private void Divide(){
        a = double.Parse(result);
        action = "divide";
        result = "0";
    }
    private void Mod(){
        a = double.Parse(result);
        action = "mod";
        result = "0";
    }
    private void Root(){
        result = (Math.Sqrt(double.Parse(result))).ToString();
    }
    private void Sup(){
        result = (Math.Pow(double.Parse(result),2)).ToString();
    }
    private void Under(){
        if (result == "0"){
            result = "0";
        }else{
            result = (1 / double.Parse(result)).ToString();
        }
    }
    private void Swap(){
        if (double.Parse(result) > 0){
            result = "-"+result;
        }else{
            result = result.Replace("-","");
        }
    }
    private void Back(){
        if (result == "0"){
            result = "0";
        }else{
            result = result.Remove(result.Length - 1, 1);
        }
    }
    private void Equal(){
        if (action == string.Empty) {
        }else{
            b = double.Parse(result);
            switch (action)
            {
                case "add":
                    result = (a + b).ToString();
                    break;
                case "subtract":
                    result = (a - b).ToString();
                    break;
                case "multiply":
                    result = (a * b).ToString();
                    break;
                case "divide":
                    result = (a / b).ToString();
                    break;
                case "mod":
                    result = (a % b).ToString();
                    break;
            }
        }
    }
}
